{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/app/dashboard/dashboard.module.scss.module.css [app-client] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"content\": \"dashboard-module-scss-module__c6XUcG__content\",\n  \"dashboardContainer\": \"dashboard-module-scss-module__c6XUcG__dashboardContainer\",\n  \"sidebar\": \"dashboard-module-scss-module__c6XUcG__sidebar\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 11, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 17, "column": 0}, "map": {"version":3,"sources":["file:///home/andrey/Projects/MyTonarFront/src/hooks/useUserPermissions.ts"],"sourcesContent":["'use client'\n\nimport { useState, useEffect } from 'react';\nimport axios from 'axios';\n\ninterface UserPermissionsState {\n  isLoading: boolean;\n  hasAccess: boolean;\n  message: string | null;\n}\n\n/**\n * Хук для проверки прав доступа пользователя к определенному ресурсу\n * @param resource - название ресурса для проверки доступа\n * @returns Объект с информацией о доступе\n */\nexport function useUserPermissions(resource: string): UserPermissionsState {\n  const [state, setState] = useState<UserPermissionsState>({\n    isLoading: true,\n    hasAccess: false,\n    message: null\n  });\n\n  useEffect(() => {\n    // Проверяем, что код выполняется в браузере\n    if (typeof window === 'undefined') return;\n    \n    const checkPermissions = async () => {\n      try {\n        const token = localStorage.getItem('access_token');\n        \n        if (!token) {\n          setState({\n            isLoading: false,\n            hasAccess: false,\n            message: 'Необходима авторизация'\n          });\n          return;\n        }\n        \n        // Запрос к API сервера для проверки прав доступа\n        const response = await axios.get(\n          `http://localhost:9091/api/${resource}`, \n          {\n            headers: {\n              'Authorization': `Bearer ${token}`\n            }\n          }\n        );\n        \n        // Проверяем ответ сервера\n        // Если есть сообщение об ошибке доступа, значит прав нет\n        if (response.data && response.data.message === \"У пользователя не хватает прав доступа\") {\n          setState({\n            isLoading: false,\n            hasAccess: false,\n            message: response.data.message\n          });\n        } else {\n          // Если сервер вернул данные без сообщения об ошибке, значит доступ есть\n          setState({\n            isLoading: false,\n            hasAccess: true,\n            message: null\n          });\n        }\n        \n      } catch (error) {\n        console.error('Ошибка при проверке прав доступа:', error);\n        \n        // Проверяем, есть ли в ответе сообщение об ошибке доступа\n        if (axios.isAxiosError(error) && error.response?.data?.message) {\n          setState({\n            isLoading: false,\n            hasAccess: false,\n            message: error.response.data.message\n          });\n        } else {\n          setState({\n            isLoading: false,\n            hasAccess: false,\n            message: error instanceof Error ? error.message : 'Произошла ошибка при проверке прав'\n          });\n        }\n      }\n    };\n\n    checkPermissions();\n  }, [resource]);\n\n  return state;\n} "],"names":[],"mappings":";;;AAEA;AACA;;AAHA;;;AAgBO,SAAS,mBAAmB,QAAgB;;IACjD,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAwB;QACvD,WAAW;QACX,WAAW;QACX,SAAS;IACX;IAEA,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;wCAAE;YACR,4CAA4C;YAC5C,uCAAmC;;YAAM;YAEzC,MAAM;iEAAmB;oBACvB,IAAI;wBACF,MAAM,QAAQ,aAAa,OAAO,CAAC;wBAEnC,IAAI,CAAC,OAAO;4BACV,SAAS;gCACP,WAAW;gCACX,WAAW;gCACX,SAAS;4BACX;4BACA;wBACF;wBAEA,iDAAiD;wBACjD,MAAM,WAAW,MAAM,wIAAA,CAAA,UAAK,CAAC,GAAG,CAC9B,CAAC,0BAA0B,EAAE,UAAU,EACvC;4BACE,SAAS;gCACP,iBAAiB,CAAC,OAAO,EAAE,OAAO;4BACpC;wBACF;wBAGF,0BAA0B;wBAC1B,yDAAyD;wBACzD,IAAI,SAAS,IAAI,IAAI,SAAS,IAAI,CAAC,OAAO,KAAK,0CAA0C;4BACvF,SAAS;gCACP,WAAW;gCACX,WAAW;gCACX,SAAS,SAAS,IAAI,CAAC,OAAO;4BAChC;wBACF,OAAO;4BACL,wEAAwE;4BACxE,SAAS;gCACP,WAAW;gCACX,WAAW;gCACX,SAAS;4BACX;wBACF;oBAEF,EAAE,OAAO,OAAO;wBACd,QAAQ,KAAK,CAAC,qCAAqC;wBAEnD,0DAA0D;wBAC1D,IAAI,wIAAA,CAAA,UAAK,CAAC,YAAY,CAAC,UAAU,MAAM,QAAQ,EAAE,MAAM,SAAS;4BAC9D,SAAS;gCACP,WAAW;gCACX,WAAW;gCACX,SAAS,MAAM,QAAQ,CAAC,IAAI,CAAC,OAAO;4BACtC;wBACF,OAAO;4BACL,SAAS;gCACP,WAAW;gCACX,WAAW;gCACX,SAAS,iBAAiB,QAAQ,MAAM,OAAO,GAAG;4BACpD;wBACF;oBACF;gBACF;;YAEA;QACF;uCAAG;QAAC;KAAS;IAEb,OAAO;AACT;GA3EgB","debugId":null}},
    {"offset": {"line": 103, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 109, "column": 0}, "map": {"version":3,"sources":["file:///home/andrey/Projects/MyTonarFront/src/app/dashboard/client.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useState } from \"react\";\nimport { useRouter, useSearchParams } from \"next/navigation\";\nimport useAuth from \"@/hooks/useAuth\";\nimport styles from './dashboard.module.scss';\nimport { useUserPermissions } from \"@/hooks/useUserPermissions\";\n\ninterface UserData {\n  name: string | null;\n  login: string | null;\n}\n\nconst DashboardClient = () => {\n  const router = useRouter();\n  const searchParams = useSearchParams();\n  const isAuth = useAuth();\n  const { isLoading, hasAccess, message } = useUserPermissions('dashboard');\n  const [user, setUser] = useState<UserData>({\n    name: null,\n    login: null\n  });\n\n  useEffect(() => {\n    if (typeof window === 'undefined') return;\n    \n    const accessToken = searchParams.get(\"access_token\");\n    const refreshToken = searchParams.get(\"refresh_token\");\n    const name = searchParams.get('user[first_name]');\n    const login = searchParams.get('user[login]');\n\n    if (accessToken) {\n      localStorage.setItem(\"access_token\", accessToken);\n      localStorage.setItem(\"refresh_token\", refreshToken || \"\");\n      localStorage.setItem(\"name\", name || \"\");\n      localStorage.setItem(\"login\", login || \"\");\n    }\n    \n    setUser({\n      name: localStorage.getItem('name'),\n      login: localStorage.getItem('login')\n    });\n  }, [searchParams, isAuth]);\n\n  if (isLoading) {\n    return <div className={styles.loading}>Проверка прав доступа...</div>;\n  }\n\n  if (!hasAccess) {\n    return (\n      <div className={styles.accessDenied}>\n        <h2>Доступ ограничен</h2>\n        <p>{message || 'Доступ к панели управления ограничен.'}</p>\n        <p className={styles.accessInfo}>Если вам необходим доступ к этому разделу, обратитесь к администратору системы.</p>\n      </div>\n    );\n  }\n\n  return (\n    <div className={styles.dashboardWelcome}>\n      <h1>Панель управления</h1>\n      {user.name ? (\n        <div className={styles.welcomeMessage}>\n          <p>Добро пожаловать, <strong>{user.name}</strong> ({user.login})</p>\n          <p>Используйте меню слева для навигации по разделам панели управления.</p>\n        </div>\n      ) : (\n        <div className={styles.loading}>Загрузка данных пользователя...</div>\n      )}\n    </div>\n  );\n};\n\nexport default DashboardClient;"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AACA;AACA;;;AANA;;;;;;AAaA,MAAM,kBAAkB;;IACtB,MAAM,SAAS,CAAA,GAAA,qIAAA,CAAA,YAAS,AAAD;IACvB,MAAM,eAAe,CAAA,GAAA,qIAAA,CAAA,kBAAe,AAAD;IACnC,MAAM,SAAS,CAAA,GAAA,2HAAA,CAAA,UAAO,AAAD;IACrB,MAAM,EAAE,SAAS,EAAE,SAAS,EAAE,OAAO,EAAE,GAAG,CAAA,GAAA,qIAAA,CAAA,qBAAkB,AAAD,EAAE;IAC7D,MAAM,CAAC,MAAM,QAAQ,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAY;QACzC,MAAM;QACN,OAAO;IACT;IAEA,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;qCAAE;YACR,uCAAmC;;YAAM;YAEzC,MAAM,cAAc,aAAa,GAAG,CAAC;YACrC,MAAM,eAAe,aAAa,GAAG,CAAC;YACtC,MAAM,OAAO,aAAa,GAAG,CAAC;YAC9B,MAAM,QAAQ,aAAa,GAAG,CAAC;YAE/B,IAAI,aAAa;gBACf,aAAa,OAAO,CAAC,gBAAgB;gBACrC,aAAa,OAAO,CAAC,iBAAiB,gBAAgB;gBACtD,aAAa,OAAO,CAAC,QAAQ,QAAQ;gBACrC,aAAa,OAAO,CAAC,SAAS,SAAS;YACzC;YAEA,QAAQ;gBACN,MAAM,aAAa,OAAO,CAAC;gBAC3B,OAAO,aAAa,OAAO,CAAC;YAC9B;QACF;oCAAG;QAAC;QAAc;KAAO;IAEzB,IAAI,WAAW;QACb,qBAAO,6LAAC;YAAI,WAAW,qKAAA,CAAA,UAAM,CAAC,OAAO;sBAAE;;;;;;IACzC;IAEA,IAAI,CAAC,WAAW;QACd,qBACE,6LAAC;YAAI,WAAW,qKAAA,CAAA,UAAM,CAAC,YAAY;;8BACjC,6LAAC;8BAAG;;;;;;8BACJ,6LAAC;8BAAG,WAAW;;;;;;8BACf,6LAAC;oBAAE,WAAW,qKAAA,CAAA,UAAM,CAAC,UAAU;8BAAE;;;;;;;;;;;;IAGvC;IAEA,qBACE,6LAAC;QAAI,WAAW,qKAAA,CAAA,UAAM,CAAC,gBAAgB;;0BACrC,6LAAC;0BAAG;;;;;;YACH,KAAK,IAAI,iBACR,6LAAC;gBAAI,WAAW,qKAAA,CAAA,UAAM,CAAC,cAAc;;kCACnC,6LAAC;;4BAAE;0CAAkB,6LAAC;0CAAQ,KAAK,IAAI;;;;;;4BAAU;4BAAG,KAAK,KAAK;4BAAC;;;;;;;kCAC/D,6LAAC;kCAAE;;;;;;;;;;;qCAGL,6LAAC;gBAAI,WAAW,qKAAA,CAAA,UAAM,CAAC,OAAO;0BAAE;;;;;;;;;;;;AAIxC;GA1DM;;QACW,qIAAA,CAAA,YAAS;QACH,qIAAA,CAAA,kBAAe;QACrB,2HAAA,CAAA,UAAO;QACoB,qIAAA,CAAA,qBAAkB;;;KAJxD;uCA4DS","debugId":null}},
    {"offset": {"line": 277, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}